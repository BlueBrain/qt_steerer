\documentclass[a4paper,twoside]{article}
\usepackage{graphicx}
\usepackage{url}
\usepackage[bf]{caption}

\setlength {\textwidth}{150mm}
\setlength {\captionmargin}{20pt}
\oddsidemargin 5mm
\evensidemargin 5mm

\begin{document}

\title{RealityGrid Steering Application User Manual}

\author{Mark Riding and Andrew Porter\\
Manchester Computing,\\University of Manchester,\\Oxford Road,\\
Manchester,\\M13 9PL.}

\maketitle

\begin{table}
\begin{center}
\begin{tabular}{l|p{5cm}|c}
\hline\hline
Author & Comments & Date \\
\hline
Andrew Porter & As released with v.1.1 of the RealityGrid steering software. & 29th April 2004 \\
Andrew Porter & Extensions for tabbed steering and additional graphing features. & 25th November 2004 \\
Andrew Porter & As released with v.1.2 of the RealityGrid steering software. & 25th April 2006\\
\hline\hline
\end{tabular}
\end{center}
\end{table}

\pagebreak

\tableofcontents

\pagebreak

\begin{section}{Acknowledgements}

The RealityGrid Steerer is mainly the work of Sue Ramsden, with some
further enhancements by Mark Riding and Andrew Porter. The steerer is
built using the RealityGrid Steering API, by Andrew Porter.

\end{section}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{section}{Introduction}

The RealityGrid Steerer is a generic user interface for performing
computational steering on (computational) jobs which have been built
using the RealityGrid Steering API. This document aims to give new
users an overview of how to use the steerer, and to explain the
functionality which it offers.

\end{section}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{section}{Configuration}

Several configuration options for the steering client are set by
means of a configuration file, `steerer.conf.'

\end{section}

\begin{section}{Starting the Steerer}

\begin{subsection}{Launching}

Run the steering application by executing the command \texttt{steerer}
at the command prompt (assuming that it is in your path). You will be
presented with a simple start-up screen:


\begin{figure}
\centerline{\includegraphics{startup_screen.eps}}
\caption{Steerer start-up screen}
\label{fig:startup_screen}
\end{figure}

\end{subsection}

\begin{subsection}{The Steerer menu}


\begin{figure}
\centerline{\includegraphics{Steerer_menu.eps}}
\caption{Steerer menu}
\label{fig:steerer_menu}
\end{figure}

The Steerer menu has five options:
\begin{itemize}
\item Local Attach: attach to a local steerable job, 
communicated with by means of a local, shared file system. 
Shortcut Ctrl+A;
\item Grid Attach: attach to a steerable job located on 
any machine, communicated with by means of a Grid-Service 
interface. Shortcut Ctrl+G;
\item Set Polling Interval: set how often (in seconds) the 
steerer polls the computational job. Shortcut Ctrl+P;
\item Turn on/off auto polling interval: toggle whether or not 
to allow the client to automatically adjust the polling interval Alt+P;
\item Quit: Quits the application. Shortcut Ctrl+Q.
\end{itemize}

The Polling Interval is an important parameter since it controls how
often the steerer checks for status messages from an attached
application.  If the steerer fails to `keep up' with the application
then status messages will be lost which may result in strange
behaviour.  For applications that generate many status reports per
second, the value of the STEERING INTERVAL steerable parameter of
that application should be increased in order to reduce the frequency
with which it generates status reports. (This steerable parameter is
automatically generated by the steering library and is thus available
for all applications that use the RealityGrid steering library.)
Allowing the steering client to automatically configure the polling
interval is recommended although users should still ensure that
applications are not generating more than about two status messages
per second.

\end{subsection}

\begin{subsection}{Attaching to a steerable job}

Selecting Local Attach from the Steerer menu will open a file-system
browser that allows you to choose the directory to use for
communication with the application that you wish to steer:

\begin{figure}
\centerline{\includegraphics{dir_browser.eps}}
\caption{Browser dialog for choosing a directory for steering communication}
\label{fig:dir_browser}
\end{figure}

This directory must match that passed to the application by way of the
REG\_STEER\_DIRECTORY environment variable.  On pressing OK the main
RealityGrid Steerer window should be displayed.  Should the steerer
fail to find an application to attach to then the Steerer start-up
screen will be displayed with a `Failed to attach' message displayed.
If this occurs then check that you have selected the correct directory
and that the application is actually running.

Selecting Grid Attach will bring up a small dialog box:

\begin{figure}
\centerline{\includegraphics{grid_attach.eps}}
\caption{Grid Attach dialog}
\label{fig:grid_attach}
\end{figure}

The dialog lists available RealityGrid applications and their
addresses (handles) in a table. Entries in the Handle column are fully
editable.  By selecting an entry in the table and clicking on the
Attach button, a Steerer is created for the chosen application. Should
the attach fail then check that the handle you've specified is correct
and that the application you are attempting to connect to is up and
running.

It is also possible (on Linux/UNIX systems) to specify the handle to
connect to on the command line when launching the steerer.

\end{subsection}
\end{section}

%------------------------------------------------------------------

\begin{section}{Using the Steerer}

\begin{subsection}{The Main Window}

\begin{figure}
\centerline{\includegraphics{main_local.eps}}
\caption{Steerer main window in local-steering mode}
\label{fig:main_local}
\end{figure}

The Main Window is split into five conceptual sections:
\begin{itemize}
\item Control Buttons
\item Monitored Parameters
\item Steered Parameters
\item Data IO
\item CheckPoint Types
\end{itemize}
The last four of these each have a table associated with them, as
shown in the figure above.  The user can choose to hide one or more of
these tables via the View menu:

\begin{figure}
\centerline{\includegraphics{main_view_menu.eps}}
\caption{The View menu on the main window}
\label{fig:view_menu}
\end{figure}

\begin{subsubsection}{Control Buttons}
\label{sec:control_btns}

The Control Buttons panel manages overall control of the steerable
job's state. Different buttons will be greyed out and unavailable
depending on a job's state; for instance, jobs that are not running
cannot be stopped.
\begin{itemize}
\item Pause/Resume: pauses a running job/resumes a paused job
\item Stop: ends the job
\item Detach: detaches the steerer from the job, leaving the 
job running
\item Close: closes the main window of the steerer, returning to the 
startup screen
\item Tell All: causes the steerer to pass any user updated 
parameters to the job, see section~\ref{sec:steered_params}.
\end{itemize}

\end{subsubsection} % Control Buttons

\begin{subsubsection}{Monitored Parameters}
\label{sec:mon_params}

The Monitored Parameters table lists parameters which are exposed by
the steerable job, but are not themselves directly steerable. An
example of a monitored parameter for a simulation job might be time
per simulation step. Such a parameter is changed only by the steered
application itself, not the user.

The Steerer allows graphs to be drawn of monitored parameters. By
right clicking on a monitored parameter, a context menu appears
allowing the user to select a `Draw History Graph' option.

\begin{figure}
\centerline{\includegraphics{hist_plot_context_menu.eps}}
\caption{Draw History Graph context menu option}
\label{fig:hist_graph_context_menu}
\end{figure}

\end{subsubsection} % Monitored Parameters

\begin{subsubsection}{Parameter History Graphs}
\label{sec:hist_graphs}

Selecting the Draw History Graph option from the context menu causes a
new window to appear, containing a simple 2D line plot of the selected
parameter's history.  The graph is constructed simply by connecting
adjacent ordinates with straight lines --- no fitting is performed.

\begin{figure}
\centerline{\includegraphics{hist_plot_2curves.eps}}
\caption{Example Parameter History Graph}
\label{fig:eg_param_hist_plot}
\end{figure}

\begin{figure}
\centerline{\includegraphics{hist_plot_menus.eps}}
\caption{The File and Graph menus of the Parameter History Graph window}
\label{fig:param_hist_menus}
\end{figure}

There are two menus available in this window
(figure~\ref{fig:param_hist_menus}), the File menu, and the Graph
menu. The File menu has four options:
\begin{itemize}
\item Print: requests a print-out of the image portion of the window. 
Shortcut Ctrl+P;
\item Save: saves the image portion of the window to disk. Shortcut Ctrl+S;
\item Save data: saves the raw data to ASCII file (pops up a file browser). 
Shortcut Ctrl+t;
\item Close: closes the window. Shortcut Ctrl+C.
\end{itemize}
The Graph menu has nine options:
\begin{itemize}
\item Auto Y Axis: allows the application to automatically determine 
the extents of the y-axis. This menu item toggles on and off. 
Shortcut Ctrl+A;
\item Define Y upper-bound: if Auto Y axis is not selected, this 
menu item becomes available. By selecting it, a dialog appears 
(see below) allowing you to enter an upper bound for the Y axis. 
If Auto Y Axis is reselected, then this value is ignored. 
Shortcut Ctrl+U;
\item Define Y lower-bound: as 'Define Y upper-bound', but for 
the lower bound. Shortcut Ctrl+L;
\item Toggle use of Log Y axis: switches between linear and 
logarithmic axis.  Manual limits cannot be set for the logarithmic 
axis and therefore those options will be disabled as appropriate. 
Shortcut Ctrl+O;
\item Auto X Axis: allows the application to automatically 
determine the extents of the x-axis. This menu item toggles on and 
off. Shortcut Alt+A;
\item Define X upper-bound: as for Y upper bound. Shortcut Alt+U;
\item Define X lower-bound: as for Y lower bound. Shortcut Alt+L;
\item Toggle use of Log X axis:	as for Log Y axis. Shortcut Alt+O;
\item Toggle display of symbols: enables/disables the display of 
symbols at data points. Shortcut Ctrl-D.
\end{itemize}
Symbols are displayed by default if the graph is of an appropriate
scale --- if resolution does not permit then they are automatically
hidden.

Note that the steering client automatically logs the values of all
monitored and steerable parameters (irrespective of whether they are
being plotted) and therefore if it is connected to a running
simulation for an extended period it may accumulate a considerable
amount of data.  Displaying a history plot of a large data set
obviously uses some computational resource, particularly if the plot
is being updated frequently.  Therefore it is recommended (in order to
maximise the responsiveness of the steering client) that history plots
be closed while not in use if the steering client is being used to
continuously monitor long runs.

\end{subsubsection} % Parameter History Graphs

\begin{subsubsection}{Steered Parameters}
\label{sec:steered_params}

The Steered Parameters list box contains a list of all steerable
parameters exposed by the current job. The first column, 'Name,' lists
the names of each of the parameters, the second, 'Value,' shows the
current value for each parameter, and the third, 'New Value,' allows
you to enter new parameters. Hovering the mouse over an entry in the
third column brings up a tool tip showing the minimum and maximum
allowable values for that parameter.  If the steerable parameter is a
string then the maximum allowable value gives the maximum length of
the string.

New values are only propagated to the running job once the entry has
been completed (by pressing Enter or leaving the cell via the cursor
keys) and the 'Tell' button is clicked. When this happens the entries
in the 'Value' column are updated to reflect the new values, and any
entries in the 'New Value' column are cleared. This action is also
performed if you click on the 'Tell All' button in the Commands button
panel.  Note that the entries in the 'Value' column are only updated
upon confirmation from the application --- this thus provides
confirmation that it has received the instruction(s).

\begin{figure}
\centerline{\includegraphics{limits_tool_tip.eps}}
\caption{Steered Parameters tool tip}
\label{fig:limits_tool_tip}
\end{figure}

\end{subsubsection} % Steered Parameters

\begin{subsubsection}{Data IO}

The Data IO table lists all data input and output channels supported
by the current job. The 'Name' column lists the name of each channel,
the 'Freq' column lists how often data is written to or read from the
channel (in time steps), the 'New Freq' column allows you to specify a
new frequency for each item, and the 'IO Type' column indicates
whether the channel is for input or output.  Each individual entry is
either an input or an output, not both. As with the steered parameters
table, updates made are not propagated to the current job until either
the 'Tell Freq's' button or the 'Tell All' button in the Commands
button panel is clicked.

It is possible to manually request that data be emitted/consumed, in
addition to the automatic events. To do so, select an entry from the
table, and click on the 'Consume' or 'Emit' button at the right of the
table. Only one of the buttons will be available for each entry,
depending on whether the data channel is for input or output.

\end{subsubsection} % Data IO

\begin{subsubsection}{CheckPoint Types}

The CheckPoint Types table lists the types of checkpoint that the
running job supports. There can be many instances (checkpoints) of
each checkpoint type, and a job may expose several checkpoint types
which differ in the parameters and data values they record. The
majority of jobs will only need a single checkpoint type.

The 'Name' column lists the names of each checkpoint type, the 'Freq'
column lists the frequency with which checkpoints are automatically
taken (in time steps), and the editable 'New Freq' column allows you
to enter new values for a checkpoint's frequency. As with the Steered
Parameter values, new frequency values are only propagated to the
running job when either the 'Tell Freq's' button or the 'Tell All'
button in the Commands button panel is pressed.

There are slight differences in the steerer main window depending on
whether local (file-based) or remote steering (using the grid-service
framework) is being performed.

Checkpointing with local steering

Checkpoints (checkpoint type instances) can be created or used to
perform a restart by means of the 'Create' and 'Restart' buttons to
the right of the main checkpoint table. These buttons will be greyed
out and unavailable by default, only becoming active if an appropriate
checkpoint type has been selected.

After clicking on the Create button for a valid checkpoint type, the
application will be instructed to create a checkpoint instance of the
selected checkpoint type.  After clicking on the Restart button for a
valid checkpoint type, a dialog is presented listing all the
checkpoint instances for that type. You can select a checkpoint
instance from the list, and instruct the application to restart from
it by clicking on the 'Restart' button. Clicking on 'Cancel' quits the
dialog without doing anything.

\begin{figure}
\centerline{\includegraphics{chk_list.eps}}
\caption{CheckPoint Selector dialog}
\label{fig:chk_list_dialog}
\end{figure}

In order to help differentiate between checkpoint instances, it is
possible to inspect the parameters of each by clicking on the
'Parameters' button. This brings up another dialog, which lists the
checkpoint instance's parameters and their values at the time the
checkpoint was taken. It is possible to have several Checkpoint
Parameters Table dialog's open at the same time, so that different
checkpoint instances can be compared and contrasted.  Again, clicking
on the 'Cancel' button closes the dialog.

\begin{figure}
\centerline{\includegraphics{chk_params.eps}}
\caption{CheckPoint Parameters Table dialog}
\label{fig:chk_params_dialog}
\end{figure}

Checkpointing with remote steering

When remote steering is in operation, the main window of the steerer
and the way in which a restart is performed is slightly different.

\begin{figure}
\centerline{\includegraphics{main_window_grid.eps}}
\caption{Steerer main window in remote-steering mode}
\label{fig:main_window_grid}
\end{figure}

A checkpoint is still created by selecting the appropriate checkpoint
type from the checkpoint table and clicking the 'Create' button.
However, the `Restart' button is now located in the panel at the top
of the window --- this is because it is no longer necessary to select a
checkpoint type before pressing it.  Instead, on pressing 'Restart,'
the user is prompted to enter the Grid Service Handle of a suitable
checkpoint.  How the user obtains this GSH is beyond the scope of this
document since it relies upon the user browsing a checkpoint tree
(using either a web interface or some tool such as the RealityGrid
launching wizard).

\end{subsubsection} % CheckPoint Types
\end{subsection} % Main window

\begin{subsection}{Steering multiple simulations}

The steering client is capable of steering a number of simulations
simultaneously.  These simulations may be local, remote or a mixture
of both.  Connecting to additional simulations is straightforward; use
the Local Attach or Grid Attach options and proceed as normal.  When
the client is successfully attached to a second application then a
second tab will be added to the main window, as shown below.

\begin{figure}
\centerline{\includegraphics{tabbed_steerer.eps}}
\caption{Tabbed steering client connected to two simulations.}
\label{fig:tabbed}
\end{figure}

Initially, the tab is labelled with either the directory or GSH of the
SGS being used to contact the simulation.  This may be edited by
selecting the Edit tab title option from the Steerer menu.

When the steerer is connected to more than one simulation then
obviously it needs to check for status messages more frequently.  This
must be borne in mind if you are setting the steerer's polling
interval manually.  However, if you are allowing the steerer to
automatically set the polling interval then this is not an issue.
Clearly, there are practical limits on how many applications the
steering client can connect to simultaneously and these are largely
governed by how often it is possible for the steering client to check
for messages.  Although it would be possible to poll for messages very
frequently, this would result in a very unresponsive GUI and therefore
the polling interval must be greater than 0.05 seconds.

\end{subsection} % Steering multiple simulations

\end{section}

\end{document}


